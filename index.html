<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculadora do 5Âº Dia Ãštil</title>
    <style>
      :root {
        --primary: #2563eb;
        --bg: #f8fafc;
        --card: #ffffff;
        --text: #1e293b;
      }

      body {
        font-family: "Segoe UI", system-ui, sans-serif;
        background-color: var(--bg);
        color: var(--text);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
      }

      .container {
        background: var(--card);
        padding: 2rem;
        border-radius: 16px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: 400px;
        text-align: center;
      }

      h1 {
        margin-bottom: 1.5rem;
        font-size: 1.5rem;
        color: var(--primary);
      }

      .controls {
        display: flex;
        gap: 10px;
        margin-bottom: 2rem;
        justify-content: center;
      }

      select {
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #cbd5e1;
        font-size: 1rem;
        background-color: white;
        cursor: pointer;
      }

      .result-box {
        background-color: #eff6ff;
        padding: 1.5rem;
        border-radius: 12px;
        margin-bottom: 1rem;
      }

      .label {
        font-size: 0.9rem;
        color: #64748b;
        margin-bottom: 0.5rem;
        display: block;
      }
      .big-date {
        font-size: 2.5rem;
        font-weight: bold;
        color: var(--primary);
        margin: 0;
      }
      .weekday {
        font-size: 1.1rem;
        color: #475569;
        margin-top: 0.5rem;
      }

      .holidays-list {
        text-align: left;
        margin-top: 1.5rem;
        font-size: 0.85rem;
        color: #64748b;
        border-top: 1px solid #e2e8f0;
        padding-top: 1rem;
      }

      .holiday-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 4px;
      }
      .holiday-date {
        font-weight: 600;
      }

      /* Estilos do RodapÃ© (Author) */
      .footer {
        margin-top: 2rem;
        font-size: 0.8rem;
        color: #94a3b8;
        border-top: 1px solid #f1f5f9;
        padding-top: 1rem;
      }

      .footer a {
        color: var(--primary);
        text-decoration: none;
        font-weight: 600;
        transition: color 0.2s;
      }

      .footer a:hover {
        color: #1d4ed8;
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ðŸ“… Dia do Pagamento</h1>

      <div class="controls">
        <select id="monthSelect"></select>
        <select id="yearSelect"></select>
      </div>

      <div style="margin-bottom: 20px">
        <label for="targetDay" style="font-size: 0.8rem; color: #64748b"
          >Calcular para o:</label
        >
        <br />
        <select id="targetDay" style="margin-top: 5px; width: 100%">
          <option value="5">5Âº Dia Ãštil (PadrÃ£o)</option>
          <option value="1">1Âº Dia Ãštil</option>
          <option value="10">10Âº Dia Ãštil</option>
          <option value="15">15Âº Dia Ãštil</option>
        </select>
      </div>

      <div class="result-box">
        <span class="label">O pagamento deve cair em:</span>
        <h2 class="big-date" id="resultDate">--/--</h2>
        <div class="weekday" id="resultWeekday">---</div>
      </div>

      <div class="holidays-list" id="holidaysList"></div>

      <div class="footer">
        Desenvolvido por
        <a
          href="https://www.linkedin.com/in/victorribeiro-dev/"
          target="_blank"
          rel="noopener noreferrer"
          >Victor Ribeiro</a
        >
      </div>
    </div>

    <script>
      // === LÃ“GICA DE FERIADOS E DATA ===

      function getEasterDate(year) {
        const a = year % 19;
        const b = Math.floor(year / 100);
        const c = year % 100;
        const d = Math.floor(b / 4);
        const e = b % 4;
        const f = Math.floor((b + 8) / 25);
        const g = Math.floor((b - f + 1) / 3);
        const h = (19 * a + b - d - g + 15) % 30;
        const i = Math.floor(c / 4);
        const k = c % 4;
        const l = (32 + 2 * e + 2 * i - h - k) % 7;
        const m = Math.floor((a + 11 * h + 22 * l) / 451);
        const month = Math.floor((h + l - 7 * m + 114) / 31);
        const day = ((h + l - 7 * m + 114) % 31) + 1;
        return new Date(year, month - 1, day);
      }

      function getHolidays(year) {
        const easter = getEasterDate(year);

        const carnival = new Date(easter);
        carnival.setDate(easter.getDate() - 47);
        const goodFriday = new Date(easter);
        goodFriday.setDate(easter.getDate() - 2);
        const corpusChristi = new Date(easter);
        corpusChristi.setDate(easter.getDate() + 60);

        const holidays = [
          { d: 1, m: 0, name: "ConfraternizaÃ§Ã£o Universal" },
          {
            d: carnival.getDate(),
            m: carnival.getMonth(),
            name: "Carnaval (Facultativo)",
          },
          {
            d: goodFriday.getDate(),
            m: goodFriday.getMonth(),
            name: "Sexta-feira Santa",
          },
          { d: 21, m: 3, name: "Tiradentes" },
          { d: 1, m: 4, name: "Dia do Trabalho" },
          {
            d: corpusChristi.getDate(),
            m: corpusChristi.getMonth(),
            name: "Corpus Christi",
          },
          { d: 7, m: 8, name: "IndependÃªncia do Brasil" },
          { d: 12, m: 9, name: "Nossa Sra. Aparecida" },
          { d: 2, m: 10, name: "Finados" },
          { d: 15, m: 10, name: "ProclamaÃ§Ã£o da RepÃºblica" },
          { d: 20, m: 10, name: "Dia da ConsciÃªncia Negra" },
          { d: 25, m: 11, name: "Natal" },
        ];

        return holidays;
      }

      function isBusinessDay(date, holidays) {
        const dayOfWeek = date.getDay();
        if (dayOfWeek === 0 || dayOfWeek === 6) return false;

        const isHoliday = holidays.some(
          (h) => h.d === date.getDate() && h.m === date.getMonth()
        );
        return !isHoliday;
      }

      function calculateBusinessDay(year, month, targetCount) {
        const holidays = getHolidays(year);
        let count = 0;
        let day = 1;
        let finalDate = null;

        while (count < targetCount) {
          let currentDate = new Date(year, month, day);
          if (currentDate.getMonth() !== month) break;

          if (isBusinessDay(currentDate, holidays)) {
            count++;
          }
          if (count === targetCount) {
            finalDate = currentDate;
          }
          day++;
        }
        return {
          date: finalDate,
          holidaysInMonth: holidays.filter((h) => h.m === month),
        };
      }

      // === INTERFACE ===

      const monthSelect = document.getElementById("monthSelect");
      const yearSelect = document.getElementById("yearSelect");
      const targetSelect = document.getElementById("targetDay");

      const months = [
        "Janeiro",
        "Fevereiro",
        "MarÃ§o",
        "Abril",
        "Maio",
        "Junho",
        "Julho",
        "Agosto",
        "Setembro",
        "Outubro",
        "Novembro",
        "Dezembro",
      ];
      months.forEach((m, i) => monthSelect.add(new Option(m, i)));

      const currentYear = new Date().getFullYear();
      for (let i = currentYear - 1; i <= currentYear + 5; i++) {
        yearSelect.add(new Option(i, i));
      }

      const today = new Date();
      monthSelect.value = today.getMonth();
      yearSelect.value = today.getFullYear();

      function updateUI() {
        const month = parseInt(monthSelect.value);
        const year = parseInt(yearSelect.value);
        const target = parseInt(targetSelect.value);

        const result = calculateBusinessDay(year, month, target);

        const dateDisplay = document.getElementById("resultDate");
        const weekdayDisplay = document.getElementById("resultWeekday");
        const holidaysList = document.getElementById("holidaysList");

        if (result.date) {
          dateDisplay.textContent = result.date.toLocaleDateString("pt-BR");
          weekdayDisplay.textContent = result.date.toLocaleDateString("pt-BR", {
            weekday: "long",
          });
        } else {
          dateDisplay.textContent = "Erro";
          weekdayDisplay.textContent = "Data invÃ¡lida";
        }

        holidaysList.innerHTML =
          result.holidaysInMonth.length > 0
            ? "<strong>Feriados/Facultativos no mÃªs:</strong><br>"
            : "";
        result.holidaysInMonth
          .sort((a, b) => a.d - b.d)
          .forEach((h) => {
            holidaysList.innerHTML += `
                <div class="holiday-item">
                    <span>${h.name}</span>
                    <span class="holiday-date">${h.d}/${h.m + 1}</span>
                </div>
            `;
          });
      }

      monthSelect.addEventListener("change", updateUI);
      yearSelect.addEventListener("change", updateUI);
      targetSelect.addEventListener("change", updateUI);

      updateUI();
    </script>
  </body>
</html>
